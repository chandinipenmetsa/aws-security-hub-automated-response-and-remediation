schemaVersion: '0.3'
description: |
  ### Document Name - AFSBP-RDS1Remediation

  ## What does this document do?
  This document modifies given Amazon RDS DB snapshot to Private using the [ModifyDBSnapshotAttribute] API.

  ## Input Parameters
  * ApplyImmediately: (Optional) A value that indicates whether the modifications in this request and any pending modifications
    are asynchronously applied as soon as possible, regardless of the PreferredMaintenanceWindow setting for the DB instance.
    * Default: "false"
  * DBSnapshotIdentifier: (Required) Amazon RDS DB snapshot identifier that needs to be modified.
  * AutomationAssumeRole: (Required) The ARN of the role that allows Automation to perform the actions on your behalf.

parameters:
  DBSnapshotIdentifier:
    type: String
    description: DB Snapshot identifier to mark private
  AutomationAssumeRole:
    type: String
    description: (Optional) The ARN of the role that allows Automation to perform the actions on your behalf.
    default: ""
mainSteps:
  - name: MakeRdsSnapshotPrivate
    action: 'aws:executeAwsApi'
    outputs:
      - Name: Response
        Selector: $
        Type: StringMap
    inputs:
      Service: rds
      Api: ModifyDBSnapshotAttribute
      DBSnapshotIdentifier: '{{DBSnapshotIdentifier}}'
      AttributeName: restore
      ValuesToRemove:
        - all
    description: Make RDS Snapshot private by running ModifyDBSnapshotAttribute API
